{include file="inc/header.html"} 
<div class="blank"></div>
	<div class="inc wb wrap register_box white box_shadow" style="width:1000px;">
		<div class="bdd">
			<div style="background:url('{$TMPL}/images/reg_logo.png') no-repeat; border:none; height:16px; width:960px; margin-top:27px;"></div>
            <div style="background:url('{$TMPL}/images/reg_now.png') no-repeat; height:58px; margin-top:27px; margin-left:15px;"></div>
			<div class="inc_main clearfix">
				<div class="user-lr-box-left f_l" style="width:810px; padding-left:150px;">
									<!--注册表单-->
									<form action="{url x="shop" r="user#doregister"}" method="post" id="signup-user-form" style="margin-top:38px;">
									<div class="field email pr">
                                            <input type="text" class="f-input ipttxt" id="signup-email-address" name="email" size="30" style="background:url('{$TMPL}/images/reg_mail.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="请输入您的邮箱">
                                            <span class="f-input-tip"></span> 
                                            <span class="hint" style="padding:0;">{$LANG.USER_TITLE_EMAIL_TIP}</span> 
									</div>
									<div class="blank1"></div>
									<div class="field username pr">
										<input type="text" class="f-input ipttxt" id="signup-username" name="user_name" size="30" style="background:url('{$TMPL}/images/reg_uname.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="请输入您的用户名">
										<span class="f-input-tip"></span> 
										<span class="hint" style="padding:0;">{$LANG.USER_TITLE_USER_NAME_TIP}</span> 
									</div>
									<div class="blank1"></div>
									<div class="field password pr">
										<input type="password" class="f-input ipttxt" id="signup-password" name="user_pwd" size="30" style="background:url('{$TMPL}/images/reg_password.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="请输入密码">
										<span class="f-input-tip"></span> 
										<span class="hint" style="padding:0;">{$LANG.USER_TITLE_USER_PWD_TIP}</span> 
									</div>
									<div class="blank1"></div>
									<div class="field password pr">
										<input type="password" class="f-input ipttxt" id="signup-password-confirm" name="user_pwd_confirm" size="30" style="background:url('{$TMPL}/images/reg_password.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="请再次输入密码">
										<span class="f-input-tip"></span>
										<span class="hint" style="padding:0;">请再次填写密码</span>
									</div>
									<div class="blank1"></div>
									<div class="field mobile pr">
										<input type="text" value="" class="f-input ipttxt" id="settings-mobile" name="mobile" size="30" style="background:url('{$TMPL}/images/reg_tel.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="请输入您的手机号码">
										<span class="f-input-tip"></span> 
										<span class="hint" style="padding:0;">{$LANG.USER_TITLE_MOBILE_TIP}</span>
									</div>	
									<div class="blank1"></div>
                                    <div class="field mobile pr">
										<input type="text" value="" class="f-input ipttxt" id="settings-mobile" name="mobile" size="30" style="background:url('{$TMPL}/images/reg_pepole.png') no-repeat; border:1px solid #d9dade; width:341px; height:34px; margin:0; padding:0; text-indent:4em; font-weight:normal; line-height:34px;" placeholder="您可以填写您的推荐人">
										<span class="f-input-tip"></span> 
										<span class="hint" style="padding:0;">已存在的用户才可以成为推荐人</span>
									</div>	
									<div class="blank1"></div>
								
									
									
									<!--{foreach from=$field_list item=field_item}
									<div class="field">
										<label id="{$field_item.field_name}_label">{$field_item.field_show_name}</label>
										{if $field_item.input_type eq 0}
										<input type="text" value="" class="f-input ipttxt" id="settings-{$field_item.field_name}" name="{$field_item.field_name}" size="30">
										{/if}
										
										{if $field_item.input_type eq 1}
										<select id="settings-{$field_item.field_name}" name="{$field_item.field_name}">
											{foreach from=$field_item.value_scope item=value_item}
											<option value="{$value_item}">{$value_item}</option>
											{/foreach}
										</select>
										{/if}
										<span class="f-input-tip"></span> 
									</div>
									<div class="blank1"></div>
									{/foreach}-->
                                    
									{if app_conf("VERIFY_IMAGE") eq 1}
									<div class="field mobile pr">
										<div class="verify_row">	
										<label style="width:auto;">验证码</label>		
										<input type="text" value="" class="f-input" name="verify" />
								
										<img src="{$APP_ROOT}/verify.php?rand={function name="rand"}" onclick="this.src='{$APP_ROOT}/verify.php?rand='+ Math.random();" title="看不清楚？换一张" />			
										</div>
									</div>
									{/if}
									
									<div class="blank"></div>
									
									<div class="act" style="margin:0;">
										<input type="submit" id="signup-submit" name="commit" value="立即注册" style=" border:none; color:#FFF; background:#ff5c00; width:380px; height:40px; border-radius:4px; line-height:40px; font-size:20px; font-weight:bold; float:left; cursor:pointer;">				
									</div>
								</form>
                                <div class="blank"></div>
                                <div class="blank"></div>
                                <div style="height:30px; margin-bottom:50px; margin-left:15px;"><img src="{$TMPL}/images/reg_anquan.png" />&nbsp;您的信息已使用加密技术，数据传输安全。</div>
					</div>
				</div>		
				<div class="inc_foot"></div>
			</div>
		</div>



<script type="text/javascript">

$(document).ready(function(){
	$('body').css('background-color','#E6E6E6');
	$('.headf').addClass('white box_shadow');
	
	$("#signup-submit").click(function(){			
		
		if($.trim($("#signup-email-address").val()).length == 0)
		{
			$("#signup-email-address").focus();
			$.showErr("{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$LANG.USER_TITLE_EMAIL}");
			
			return false;
		}
		
		if(!$.checkEmail($("#signup-email-address").val()))
		{
			$("#signup-email-address").focus();			
			$.showErr("{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_EMAIL}");
			return false;
		}
		
		if(!$.minLength($("#signup-username").val(),3,true))
		{
			$("#signup-username").focus();
			$.showErr("{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_NAME}");		
			return false;
		}
		
		if(!$.maxLength($("#signup-username").val(),16,true))
		{
			$("#signup-username").focus();
			$.showErr("{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_NAME}");			
			return false;
		}
		
		if(!$.minLength($("#signup-password").val(),4,false))
		{
			$("#signup-password").focus();
			$.showErr("{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_PWD}");	
			return false;
		}
		
		if($("#signup-password-confirm").val() != $("#signup-password").val())
		{
			$("#signup-password-confirm").focus();
			$.showErr("{$LANG.USER_PWD_CONFIRM_ERROR}");			
			return false;
		}

		if(!$.checkMobilePhone($("#settings-mobile").val()))
		{
			$("#settings-mobile").focus();			
			$.showErr("{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_MOBILE}");	
			return false;
		}	

		{if app_conf("MOBILE_MUST") eq 1}
			if($.trim($("#settings-mobile").val()).length == 0)
			{
				$("#settings-mobile").focus();
				$.showErr("{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$LANG.USER_TITLE_MOBILE}");
				
				return false;
			}
		{/if}
		

		{foreach from=$field_list item=field_item}
			{if $field_item.is_must eq 1}
			if($("#settings-{$field_item.field_name}").val()=='')
			{
				$.showErr("{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$field_item.field_show_name}");	
				$("#settings-{$field_item.field_name}").focus();
				return false;
			}
			{/if}
		{/foreach}
		if($("#referral_status").val()==1)
		{
			$.showErr("推荐人不存在");
			return false;
			}

	});
	
	
	//开始绑定 
	$("#signup-email-address").bind("blur",function(){
		if($.trim($("#signup-email-address").val()).length == 0)
		{
			formError($("#signup-email-address"),"{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$LANG.USER_TITLE_EMAIL}");			
			return false;
		}
		
		if(!$.checkEmail($("#signup-email-address").val()))
		{
			formError($("#signup-email-address"),"{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_EMAIL}");
			return false;
		}	
		
		var ajaxurl = APP_ROOT+"/index.php?ctl=ajax&act=check_field";
		var query = new Object();
		query.field_name = "email";
		query.field_data = $.trim($(this).val());
		$.ajax({ 
			url: ajaxurl,
			data:query,
			type: "POST",
			dataType: "json",
			success: function(data){
				if(data.status==1)
				{
					formSuccess($("#signup-email-address"),"{$LANG.CAN_USED}");
					return false;
				}
				else
				{
					formError($("#signup-email-address"),data.info);
					return false;
				}
			}
		});	
	}); //邮箱验证
	
	
	
	$("#signup-username").bind("blur",function(){
		if(!$.minLength($("#signup-username").val(),3,true))
		{
			formError($("#signup-username"),"{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_NAME}");		
			return false;
		}
		
		if(!$.maxLength($("#signup-username").val(),16,true))
		{
			formError($("#signup-username"),"{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_NAME}");			
			return false;
		}	
		
		var ajaxurl = APP_ROOT+"/index.php?ctl=ajax&act=check_field";
		var query = new Object();
		query.field_name = "user_name";
		query.field_data = $.trim($(this).val());
		$.ajax({ 
			url: ajaxurl,
			data:query,
			type: "POST",
			dataType: "json",
			success: function(data){
				if(data.status==1)
				{
					formSuccess($("#signup-username"),"{$LANG.CAN_USED}");
					return false;
				}
				else
				{
					formError($("#signup-username"),data.info);
					return false;
				}
			}
		});	
	}); //用户名验证
	
	
	$("#signup-password").bind("blur",function(){
		if(!$.minLength($("#signup-password").val(),4,false))
		{
			formError($("#signup-password"),"{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_USER_PWD}");	
			return false;
		}
		formSuccess($("#signup-password"),"{$LANG.CAN_USED}");
	}); //密码验证
	
	$("#signup-password-confirm").bind("blur",function(){
		if($("#signup-password-confirm").val() != $("#signup-password").val())
		{
			formError($("#signup-password-confirm"),"{$LANG.USER_PWD_CONFIRM_ERROR}");			
			return false;
		}
		formSuccess($("#signup-password-confirm"),"{$LANG.VERIFY_SUCCESS}");
	}); //确认密码验证
	
	$("#settings-mobile").bind("blur",function(){
		if(!$.checkMobilePhone($("#settings-mobile").val()))
		{
			formError($("#settings-mobile"),"{function name="sprintf" format=$LANG.FORMAT_ERROR_TIP value=$LANG.USER_TITLE_MOBILE}");	
			return false;
		}	

		{if app_conf("MOBILE_MUST") eq 1}
			if($.trim($("#settings-mobile").val()).length == 0)
			{				
				formError($("#settings-mobile"),"{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$LANG.USER_TITLE_MOBILE}");
				return false;
			}
		{/if}
		
		var ajaxurl = APP_ROOT+"/index.php?ctl=ajax&act=check_field";
		var query = new Object();
		query.field_name = "mobile";
		query.field_data = $.trim($(this).val());
		$.ajax({ 
			url: ajaxurl,
			data:query,
			type: "POST",
			dataType: "json",
			success: function(data){
				if(data.status==1)
				{
					if(query.field_data!='')
					formSuccess($("#settings-mobile"),"{$LANG.CAN_USED}");
					else
					formSuccess($("#settings-mobile"),"");
					return false;
				}
				else
				{					
					formError($("#settings-mobile"),data.info);
					return false;
				}
			}
		});	
	}); //手机验证
	
	//lu 判断推荐人
	
	$("#referral").bind("blur",function(){
		
		var ajaxurl = APP_ROOT+"/index.php?ctl=ajax&act=check_field";
		var query = new Object();
		query.field_name = "user_name";
		query.field_data = $.trim($(this).val());
		$.ajax({ 
			url: ajaxurl,
			data:query,
			type: "POST",
			dataType: "json",
			success: function(data){
				//status==1 没有该推荐人
				if(data.status==0)
				{
					formSuccess($("#referral"),"可用推荐人");
					$("#referral_status").val(data.status);
					return false;
				}
				else
				{					
					formError($("#referral"),"推荐人不存在");
					$("#referral_status").val(data.status);
					return false;
				}
			}
		});	
	});
	
	
	{foreach from=$field_list item=field_item}
			{if $field_item.is_must eq 1}			
			$("#settings-{$field_item.field_name}").bind("blur",function(){
				if($("#settings-{$field_item.field_name}").val()=='')
				{
					formError($("#settings-{$field_item.field_name}"),"{function name="sprintf" format=$LANG.EMPTY_ERROR_TIP value=$field_item.field_show_name}");	
					return false;
				}
				formSuccess($("#settings-{$field_item.field_name}"),"");
			}); //扩展字段		
			{/if}
	{/foreach}
});
</script>
</div>
<div class="blank"></div>

{include file="inc/footer.html"}

</body>
</html>